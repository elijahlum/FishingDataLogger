<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Fishing Trip Logger - Manual Entry</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
    body {
        font-family: Arial, sans-serif;
        max-width: 900px;
        margin: auto;
        padding: 20px;
        background: #f8f8f8;
    }
    h2 {
        text-align: center;
    }
    form {
        background: #fff;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        margin-bottom: 20px;
    }
    label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    input {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        box-sizing: border-box;
    }
    button {
        margin-top: 15px;
        padding: 10px;
        border: none;
        background: #007bff;
        color: white;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background: #0056b3;
    }
    .action-btn {
        background: #dc3545;
        color: white;
        padding: 5px 10px;
        font-size: 12px;
        border-radius: 5px;
        cursor: pointer;
        border: none;
    }
    .action-btn:hover {
        background: #a71d2a;
    }
    #entryTable {
        width: 100%;
        border-collapse: collapse;
        background: #fff;
        margin-top: 20px;
    }
    #entryTable th, #entryTable td {
        border: 1px solid #ccc;
        padding: 8px;
        text-align: left;
        font-size: 14px;
    }
    #entryTable th {
        background: #007bff;
        color: white;
    }
</style>
</head>
<body>

<h2>Fishing Trip Logger (Manual Entry with Local Storage)</h2>

<form id="manualForm">
    <label>Title: <input type="text" id="title" required></label>
    <label>Date: <input type="date" id="date" required></label>
    <label>Time: <input type="time" id="time" required></label>
    <label>Latitude: <input type="text" id="latitude"></label>
    <label>Longitude: <input type="text" id="longitude"></label>
    <label>Area Name: <input type="text" id="area"></label>
    <label>Weather Temp (Â°F): <input type="text" id="weatherTemp"></label>
    <label>Weather Condition: <input type="text" id="weatherCondition"></label>
    <label>Tide Station ID Used: <input type="text" id="tideStation"></label>
    <label>Tide Stage: <input type="text" id="tideStage"></label>
    <label>Moon Phase: <input type="text" id="moonPhase"></label>
    <label>Barometric Current (hPa): <input type="text" id="baroCurrent"></label>
    <label>Barometric 6 hrs Ago (hPa): <input type="text" id="baro6hrs"></label>
    <label>Barometric Pressure Trend: <input type="text" id="baroTrend"></label>

    <div style="display:flex; justify-content: space-between;">
        <button type="submit">Add Entry</button>
        <button type="button" onclick="exportToExcel()">Download Excel</button>
    </div>
</form>

<table id="entryTable">
    <thead>
        <tr>
            <th>Title</th>
            <th>Date</th>
            <th>Time</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Area</th>
            <th>Weather Temp</th>
            <th>Weather Condition</th>
            <th>Tide Station</th>
            <th>Tide Stage</th>
            <th>Moon Phase</th>
            <th>Baro Current</th>
            <th>Baro 6hrs Ago</th>
            <th>Baro Trend</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
    const form = document.getElementById("manualForm");
    const tableBody = document.querySelector("#entryTable tbody");
    let entries = JSON.parse(localStorage.getItem("fishingEntries")) || [];

    // Load saved entries on page load
    window.onload = function() {
        entries.forEach((entry, index) => addRow(entry, index));
    };

    form.addEventListener("submit", function(e) {
        e.preventDefault();

        const data = {
            Title: document.getElementById("title").value,
            Date: document.getElementById("date").value,
            Time: document.getElementById("time").value,
            Latitude: document.getElementById("latitude").value,
            Longitude: document.getElementById("longitude").value,
            Area_Name: document.getElementById("area").value,
            Weather_Temp: document.getElementById("weatherTemp").value,
            Weather_Condition: document.getElementById("weatherCondition").value,
            Tide_Station_ID_Used: document.getElementById("tideStation").value,
            Tide_Stage: document.getElementById("tideStage").value,
            Moon_Phase: document.getElementById("moonPhase").value,
            Barometric_Current: document.getElementById("baroCurrent").value,
            Barometric_6hrs_Ago: document.getElementById("baro6hrs").value,
            Barometric_Pressure_Trend: document.getElementById("baroTrend").value
        };

        entries.push(data);
        localStorage.setItem("fishingEntries", JSON.stringify(entries));

        addRow(data, entries.length - 1);
        form.reset();
    });

    function addRow(data, index) {
        const row = document.createElement("tr");

        Object.values(data).forEach(val => {
            const cell = document.createElement("td");
            cell.textContent = val;
            row.appendChild(cell);
        });

        // Action Button
        const actionCell = document.createElement("td");
        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Delete";
        deleteBtn.classList.add("action-btn");
        deleteBtn.onclick = function() {
            deleteEntry(index);
        };
        actionCell.appendChild(deleteBtn);
        row.appendChild(actionCell);

        tableBody.appendChild(row);
    }

    function deleteEntry(index) {
        entries.splice(index, 1);
        localStorage.setItem("fishingEntries", JSON.stringify(entries));
        refreshTable();
    }

    function refreshTable() {
        tableBody.innerHTML = "";
        entries.forEach((entry, index) => addRow(entry, index));
    }

    function exportToExcel() {
        const ws = XLSX.utils.json_to_sheet(entries);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Fishing Log");
        XLSX.writeFile(wb, "fishing_log_manual.xlsx");
    }
</script>

</body>
</html>
